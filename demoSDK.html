<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何开发前端sdk | demo sdk</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="demo sdk">
    
    <link rel="preload" href="/sdk-guid/assets/css/0.styles.1950effb.css" as="style"><link rel="preload" href="/sdk-guid/assets/js/app.89ed8e5d.js" as="script"><link rel="preload" href="/sdk-guid/assets/js/2.3c2e6582.js" as="script"><link rel="preload" href="/sdk-guid/assets/js/8.d8d44085.js" as="script"><link rel="prefetch" href="/sdk-guid/assets/js/3.00931c64.js"><link rel="prefetch" href="/sdk-guid/assets/js/4.da8b72e6.js"><link rel="prefetch" href="/sdk-guid/assets/js/5.048c6337.js"><link rel="prefetch" href="/sdk-guid/assets/js/6.29f38f88.js"><link rel="prefetch" href="/sdk-guid/assets/js/7.6565079b.js"><link rel="prefetch" href="/sdk-guid/assets/js/9.e68097ac.js">
    <link rel="stylesheet" href="/sdk-guid/assets/css/0.styles.1950effb.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/sdk-guid/" class="home-link router-link-active"><!----> <span class="site-name">demo sdk</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/sdk-guid/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/sdk-guid/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="https://google.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/sdk-guid/demoSDK.html" aria-current="page" class="active sidebar-link">DemoSDK文档</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/sdk-guid/demoSDK.html#如何开发前端sdk" class="sidebar-link">如何开发前端sdk</a></li><li class="sidebar-sub-header"><a href="/sdk-guid/demoSDK.html#开发前的思考" class="sidebar-link">开发前的思考</a></li><li class="sidebar-sub-header"><a href="/sdk-guid/demoSDK.html#rollup-webpack-打包区别" class="sidebar-link">rollup / webpack 打包区别</a></li><li class="sidebar-sub-header"><a href="/sdk-guid/demoSDK.html#对比一下-webpack打包和rollup打包" class="sidebar-link">对比一下 webpack打包和rollup打包</a></li><li class="sidebar-sub-header"><a href="/sdk-guid/demoSDK.html#本地测试" class="sidebar-link">本地测试</a></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="如何开发前端sdk"><a href="#如何开发前端sdk" class="header-anchor">#</a> 如何开发前端sdk</h2> <blockquote><p>前端SDK是什么？前端SDK是为了帮助前端实现特定需求，而向开发者暴露的一些JS-API的集合，规范的SDK包括若干API实现、说明文档等
例如：
JS类库，（dayjs， loadsh，jquery, AlipayJSBridge等）
UI组件库 （antd，antd-mobile，element-ui， vant等）</p></blockquote> <h2 id="开发前的思考"><a href="#开发前的思考" class="header-anchor">#</a> 开发前的思考</h2> <ul><li>1.明确业务范围，满足一类功能的需求</li> <li>2.最少的依赖原则
<ul><li>SDK减少依赖，要避免Lodash、JQuery、Moment、Dayjs等库，尽可能自行实现必要的方法，或者引入尽量小的库。否则会导致SDK打包后过大，或者更新版本带来的兼容问题</li></ul></li> <li>3.稳定，向后兼容</li> <li>4.易扩展
<ul><li>模块化实现方法，尽量小的封装函数，保持函数功能的单一性原则，这样就可以更好的增加SDK的能力。</li></ul></li> <li>5.构建工具和技术选择
提供的SDK一般都要提供压缩和未压缩版本，未压缩可以用来帮助开发调用，查找问题。压缩版本可以使用在生产环境，减少http损耗。所以我们要借助构建工具来集成这部分的能力。
可供选择的压缩工具有很多：<a href="https://www.webpackjs.com" target="_blank" rel="noopener noreferrer">webpack<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.rollupjs.com/" target="_blank" rel="noopener noreferrer">Rollup<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>、<a href="https://www.gulpjs.com.cn/docs/getting-started/quick-start" target="_blank" rel="noopener noreferrer">Gulp<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
如果是纯类库的压缩，当然是 Rollup更好，压缩更彻底,产物没有过多的注释说明
如果是有DOM和样式，那么使用webpack功能更强大</li> <li>6.SDK支持的引入方式
浏览器js模块化常见的几种方式包括：amd\cmd\es6 modules\umd</li></ul> <blockquote><p>1.静态资源引入</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">&quot;xxxx.xxx&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>
</code></pre></div><blockquote><p>2.amd引入的方式
RequireJs 依赖前置， 并行加载js文件同时，还会解析执行该模块，因为还需要执行，所以在加载某个模块前，这个模块的依赖模块需要先加载完成</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">[</span>jquery<span class="token punctuation">.</span>js<span class="token punctuation">,</span> lodash<span class="token punctuation">.</span>js<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">$<span class="token punctuation">,</span> _</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;jquery and lodash&quot;</span><span class="token punctuation">,</span> $<span class="token punctuation">,</span> _<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>3.cmd引入的方式
SeaJs 依赖就近，依赖的模块只有使用到的时候才会去执行SeaJs</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token function">define</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">require</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> lodash <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./a.js'</span><span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;lodash&quot;</span><span class="token punctuation">,</span> lodash<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>4.支持es6引入</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token keyword">import</span> MySDK <span class="token keyword">from</span> <span class="token string">'xxxx'</span>
</code></pre></div><h5 id="可以直接配置打包模式为umd-然后就可以支持上面的多种引入方式"><a href="#可以直接配置打包模式为umd-然后就可以支持上面的多种引入方式" class="header-anchor">#</a> ***  可以直接配置打包模式为umd ，然后就可以支持上面的多种引入方式 ***</h5> <div class="language-js extra-class"><pre class="language-js"><code>    <span class="token comment">//rollup.config.js</span>
    <span class="token literal-property property">output</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">'lib/index'</span><span class="token punctuation">,</span> <span class="token comment">// 通用模块</span>
        <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token string">'umd'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MySDK'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="rollup-webpack-打包区别"><a href="#rollup-webpack-打包区别" class="header-anchor">#</a> rollup / webpack 打包区别</h2> <blockquote><p>rollup</p></blockquote> <ul><li>Rollup 是一个 JavaScript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序。Rollup 对代码模块使用新的标准化格式，这些标准都包含在 JavaScript 的 ES6 版本中，而不是以前的特殊解决方案，如 CommonJS 和 AMD。ES6 模块可以使你自由、无缝地使用你最喜爱的 library 中那些最有用独立函数，而你的项目不必携带其他未使用的代码。ES6 模块最终还是要由浏览器原生实现，但当前 Rollup 可以使你提前体验。</li> <li>基于es6模块， 静态分析代码中的import，并将派出任何未实际使用的代码。（Tree-shaking）</li></ul> <p>使用流程
编写esm代码 -&gt; rollup通过入口，递归识别esm模块 -&gt; 最终打包成一个或多个bundle.js -&gt; 浏览器直接可以支持引入</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">&lt;</span>script type<span class="token operator">=</span><span class="token string">&quot;module&quot;</span><span class="token operator">&gt;</span>
</code></pre></div><p>打包成npm包的话：</p> <p>编写esm代码 -&gt; rollup通过入口，递归识别esm模块 -&gt; （可以支持配置输出多种格式的模块，如esm、cjs、umd、amd）最终打包成一个或多个bundle.js</p> <p>（如果要写cjs也可以，需要插件@rollup/plugin-commonjs commonjs模块转换插件）</p> <p>很明显，rollup 比较适合打包js库（react、vue等的源代码库都是rollup打包的）或 高版本无需往下兼容的浏览器应用程序
这样打包出来的库，可以充分使用上esm的tree shaking，使源库体积最小</p> <h2 id="对比一下-webpack打包和rollup打包"><a href="#对比一下-webpack打包和rollup打包" class="header-anchor">#</a> 对比一下 webpack打包和rollup打包</h2> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">// 入口文件 index.js</span>
  <span class="token keyword">import</span> <span class="token constant">B</span> <span class="token keyword">from</span> <span class="token string">'./b.js'</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">B</span><span class="token punctuation">)</span>


  <span class="token comment">// b.js</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">a</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">+</span> y<span class="token punctuation">)</span>
  <span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">x<span class="token punctuation">,</span> y</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>x <span class="token operator">*</span> y<span class="token punctuation">)</span>
</code></pre></div><h2 id="本地测试"><a href="#本地测试" class="header-anchor">#</a> 本地测试</h2> <p>作为项目的依赖去安装使用。但是在开发调试中需要频繁的打包发布，然后项目中再安装依赖，这种重复的操作非常的繁琐和不便，为了解决这一系列重复的操作，可以使用npm-link指令将模块链接到项目中。</p> <blockquote><p>建立链接</p></blockquote> <p>假设项目名称为project1，和一个公用组件模块upload,现需要在项目中使用upload，且upload是作为npm打包成项目依赖。</p> <p>首先第一步，使用npm link将upload模块创建成本地依赖包。在upload目录下输入命令：</p> <div class="language-js extra-class"><pre class="language-js"><code>npm link  <span class="token comment">// 将当前的包链接到全局，node_modules</span>
</code></pre></div><p>然后进入到project1项目目录里，和本地upload模块建立链接。命令中‘upload’是upload模块中package.json的name属性值，而不是目录名称。</p> <div class="language-js extra-class"><pre class="language-js"><code>npm link upload
</code></pre></div><p><img src="https://mdn.alipayobjects.com/loan_rubiks/afts/img/A*QfC-RoJhobYAAAAAAAAAAAAADm51AQ/original" alt=""></p> <p>现在在project1中的node_models里就会添加一个upload模块的软连接。就说明项目链接模块成功了。
之后修改upload里的内容就会实时更新，而不用打包发布再安装依赖。</p> <blockquote><p>解除链接</p></blockquote> <p>解除项目的依赖直接在项目目录里输入命令：</p> <div class="language-js extra-class"><pre class="language-js"><code>  npm unlink upload
</code></pre></div><p>这样项目里就解除了upload模块的软连接，然后可以在输入npm i ‘包名’ 安装你发布更新好的upload模块包。</p> <p>要解除本地upload包，在upload目录中输入命令：</p> <div class="language-js extra-class"><pre class="language-js"><code>  npm unlink upload
</code></pre></div><p>这样本地的upload包模块就解除了，其他项目的软连接也失效了。</p> <p>开发完成后，进行本地打包npm run build，</p> <p>然后npm login 登录自己的npm账号    <a href="https://www.npmjs.com/" target="_blank" rel="noopener noreferrer">npm官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>登录成功后， npm publish
<img src="https://mdn.alipayobjects.com/loan_rubiks/afts/img/A*l1GiRo2DzU8AAAAAAAAAAAAADm51AQ/original" alt="成功后截图"></p></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/sdk-guid/assets/js/app.89ed8e5d.js" defer></script><script src="/sdk-guid/assets/js/2.3c2e6582.js" defer></script><script src="/sdk-guid/assets/js/8.d8d44085.js" defer></script>
  </body>
</html>
