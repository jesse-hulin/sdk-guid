(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{274:function(s,t,a){"use strict";a.r(t);var n=a(13),r=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"如何开发前端sdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#如何开发前端sdk"}},[s._v("#")]),s._v(" 如何开发前端sdk")]),s._v(" "),t("blockquote",[t("p",[s._v("前端SDK是什么？前端SDK是为了帮助前端实现特定需求，而向开发者暴露的一些JS-API的集合，规范的SDK包括若干API实现、说明文档等\n例如：\nJS类库，（dayjs， loadsh，jquery, AlipayJSBridge等）\nUI组件库 （antd，antd-mobile，element-ui， vant等）")])]),s._v(" "),t("h2",{attrs:{id:"开发前的思考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开发前的思考"}},[s._v("#")]),s._v(" 开发前的思考")]),s._v(" "),t("ul",[t("li",[s._v("1.明确业务范围，满足一类功能的需求")]),s._v(" "),t("li",[s._v("2.最少的依赖原则\n"),t("ul",[t("li",[s._v("SDK减少依赖，要避免Lodash、JQuery、Moment、Dayjs等库，尽可能自行实现必要的方法，或者引入尽量小的库。否则会导致SDK打包后过大，或者更新版本带来的兼容问题")])])]),s._v(" "),t("li",[s._v("3.稳定，向后兼容")]),s._v(" "),t("li",[s._v("4.易扩展\n"),t("ul",[t("li",[s._v("模块化实现方法，尽量小的封装函数，保持函数功能的单一性原则，这样就可以更好的增加SDK的能力。")])])]),s._v(" "),t("li",[s._v("5.构建工具和技术选择\n提供的SDK一般都要提供压缩和未压缩版本，未压缩可以用来帮助开发调用，查找问题。压缩版本可以使用在生产环境，减少http损耗。所以我们要借助构建工具来集成这部分的能力。\n可供选择的压缩工具有很多："),t("a",{attrs:{href:"https://www.webpackjs.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("webpack"),t("OutboundLink")],1),s._v("、"),t("a",{attrs:{href:"https://www.rollupjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Rollup"),t("OutboundLink")],1),s._v("、"),t("a",{attrs:{href:"https://www.gulpjs.com.cn/docs/getting-started/quick-start",target:"_blank",rel:"noopener noreferrer"}},[s._v("Gulp"),t("OutboundLink")],1),s._v("\n如果是纯类库的压缩，当然是 Rollup更好，压缩更彻底,产物没有过多的注释说明\n如果是有DOM和样式，那么使用webpack功能更强大")]),s._v(" "),t("li",[s._v("6.SDK支持的引入方式\n浏览器js模块化常见的几种方式包括：amd\\cmd\\es6 modules\\umd")])]),s._v(" "),t("blockquote",[t("p",[s._v("1.静态资源引入")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script src"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xxxx.xxx"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("script"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("2.amd引入的方式\nRequireJs 依赖前置， 并行加载js文件同时，还会解析执行该模块，因为还需要执行，所以在加载某个模块前，这个模块的依赖模块需要先加载完成")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("define")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("jquery"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lodash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("js"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("$"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jquery and lodash"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" $"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" _"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("3.cmd引入的方式\nSeaJs 依赖就近，依赖的模块只有使用到的时候才会去执行SeaJs")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("define")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("function")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" lodash "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("require")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./a.js'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n        console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lodash"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" lodash"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("blockquote",[t("p",[s._v("4.支持es6引入")])]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" MySDK "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxx'")]),s._v("\n")])])]),t("h5",{attrs:{id:"可以直接配置打包模式为umd-然后就可以支持上面的多种引入方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可以直接配置打包模式为umd-然后就可以支持上面的多种引入方式"}},[s._v("#")]),s._v(" ***  可以直接配置打包模式为umd ，然后就可以支持上面的多种引入方式 ***")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//rollup.config.js")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("output")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("file")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'lib/index'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 通用模块")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'umd'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'MySDK'")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n")])])]),t("h2",{attrs:{id:"rollup-webpack-打包区别"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#rollup-webpack-打包区别"}},[s._v("#")]),s._v(" rollup / webpack 打包区别")]),s._v(" "),t("blockquote",[t("p",[s._v("rollup")])]),s._v(" "),t("ul",[t("li",[s._v("Rollup 是一个 JavaScript 模块打包器，可以将小块代码编译成大块复杂的代码，例如 library 或应用程序。Rollup 对代码模块使用新的标准化格式，这些标准都包含在 JavaScript 的 ES6 版本中，而不是以前的特殊解决方案，如 CommonJS 和 AMD。ES6 模块可以使你自由、无缝地使用你最喜爱的 library 中那些最有用独立函数，而你的项目不必携带其他未使用的代码。ES6 模块最终还是要由浏览器原生实现，但当前 Rollup 可以使你提前体验。")]),s._v(" "),t("li",[s._v("基于es6模块， 静态分析代码中的import，并将派出任何未实际使用的代码。（Tree-shaking）")])]),s._v(" "),t("p",[s._v("使用流程\n编写esm代码 -> rollup通过入口，递归识别esm模块 -> 最终打包成一个或多个bundle.js -> 浏览器直接可以支持引入")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("script type"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"module"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("打包成npm包的话：")]),s._v(" "),t("p",[s._v("编写esm代码 -> rollup通过入口，递归识别esm模块 -> （可以支持配置输出多种格式的模块，如esm、cjs、umd、amd）最终打包成一个或多个bundle.js")]),s._v(" "),t("p",[s._v("（如果要写cjs也可以，需要插件@rollup/plugin-commonjs commonjs模块转换插件）")]),s._v(" "),t("p",[s._v("很明显，rollup 比较适合打包js库（react、vue等的源代码库都是rollup打包的）或 高版本无需往下兼容的浏览器应用程序\n这样打包出来的库，可以充分使用上esm的tree shaking，使源库体积最小")]),s._v(" "),t("h2",{attrs:{id:"对比一下-webpack打包和rollup打包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对比一下-webpack打包和rollup打包"}},[s._v("#")]),s._v(" 对比一下 webpack打包和rollup打包")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 入口文件 index.js")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("from")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'./b.js'")]),s._v("\n  console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token constant"}},[s._v("B")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// b.js")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("a")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" y")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function-variable function"}},[s._v("b")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token parameter"}},[s._v("x"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" y")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=>")]),s._v(" console"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("x "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" y"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h2",{attrs:{id:"本地测试"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#本地测试"}},[s._v("#")]),s._v(" 本地测试")]),s._v(" "),t("p",[s._v("作为项目的依赖去安装使用。但是在开发调试中需要频繁的打包发布，然后项目中再安装依赖，这种重复的操作非常的繁琐和不便，为了解决这一系列重复的操作，可以使用npm-link指令将模块链接到项目中。")]),s._v(" "),t("blockquote",[t("p",[s._v("建立链接")])]),s._v(" "),t("p",[s._v("假设项目名称为project1，和一个公用组件模块upload,现需要在项目中使用upload，且upload是作为npm打包成项目依赖。")]),s._v(" "),t("p",[s._v("首先第一步，使用npm link将upload模块创建成本地依赖包。在upload目录下输入命令：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("npm link  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 将当前的包链接到全局，node_modules")]),s._v("\n")])])]),t("p",[s._v("然后进入到project1项目目录里，和本地upload模块建立链接。命令中‘upload’是upload模块中package.json的name属性值，而不是目录名称。")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("npm link upload\n")])])]),t("p",[t("img",{attrs:{src:"https://mdn.alipayobjects.com/loan_rubiks/afts/img/A*QfC-RoJhobYAAAAAAAAAAAAADm51AQ/original",alt:""}})]),s._v(" "),t("p",[s._v("现在在project1中的node_models里就会添加一个upload模块的软连接。就说明项目链接模块成功了。\n之后修改upload里的内容就会实时更新，而不用打包发布再安装依赖。")]),s._v(" "),t("blockquote",[t("p",[s._v("解除链接")])]),s._v(" "),t("p",[s._v("解除项目的依赖直接在项目目录里输入命令：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  npm unlink upload\n")])])]),t("p",[s._v("这样项目里就解除了upload模块的软连接，然后可以在输入npm i ‘包名’ 安装你发布更新好的upload模块包。")]),s._v(" "),t("p",[s._v("要解除本地upload包，在upload目录中输入命令：")]),s._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[s._v("  npm unlink upload\n")])])]),t("p",[s._v("这样本地的upload包模块就解除了，其他项目的软连接也失效了。")]),s._v(" "),t("p",[s._v("开发完成后，进行本地打包npm run build，")]),s._v(" "),t("p",[s._v("然后npm login 登录自己的npm账号    "),t("a",{attrs:{href:"https://www.npmjs.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("npm官网"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("登录成功后， npm publish\n"),t("img",{attrs:{src:"https://mdn.alipayobjects.com/loan_rubiks/afts/img/A*l1GiRo2DzU8AAAAAAAAAAAAADm51AQ/original",alt:"成功后截图"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);